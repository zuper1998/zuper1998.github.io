## Malware



### Definiton of Malware
+ malicious sofware
+ minden ami rosz dolgot csinál akaratunkon kivűl, pl windows update
+ magában foglalja a vírusokat, férgeket és trújaiakat

### Vírus
+ mikor lefut belemásolja magát más programokba
+ szüksége van egy host-ra
  + ha a host futattva van a malicious kód is fut
+ replikálás mellet csinálhat valami negatív dolgot
  + information stealing
  + delete files
  + install skyrim
  + adWare

### Worm
+ egyedülálló program , önmagát replikálja
+ kihasználható biztonsági rések segítségével terjed
+ replikálás mellet csinálhat valami negatív dolgot

### Trojan horse
+ hasznos program futása mellet még csinál valami gonoiszat  is
+ pl RAT: add egy backdoor a támadónak
+ lehet időzített is



### Célzott támadások
+ kémkedés és szabotázs miatt
+ vírusokkal "eljutnak" a cél szervezet gépeikig
+ pl stuxnet


### Attack vectors used by malware
+ email: YOU WON A FREE IPHONE 2 CLICK HERE TO DOWNLOAD MÖRE RAM
  + néha az attachmentben, pl vírusos pdf
+ Drive-by-Download
  + drive-by-email: az emailben js letölti a 15. skyrimet
  + link az emailben egy vírusos oldalra:
    + automatikusan lefut a js kód letölti és futattja a malicious kódot
  + watering hole attack
    + vírus elhelyezve olyan helyen ahol sokan járnak a potenciális célpontból
    + linking_park_numb.mp3.exe
+ File sharing
  + peer-to-peer

+ portable media pl usb
  + autorun
  + nem pendriveként müködik hanem billentyűzetként
+ Network vuln exploits
  + worm használja


### Cascade virus

+ betük [leesnek](https://www.youtube.com/watch?v=UWLg6tTeQRg)

### Packer
+ obfuscation
+ kód alapu felismerés elkerülése

### Malware analysis
+ Behaviour
  + megnézni mit csinál mikor elkapja valamelyik gép
+ Static
  + szétszedni és megnézni pl IDA pro segítségével
+ Dynamic
  + Debug the virus

### Malware hunting
+ Saját mintához hasonló vírusok keresése
+ Miért
  + lehet megtalálható vele az author
  + meg lehet találni más hardcoded CNC szervert

### Left-to-right-override (LRO) sample
+ funky karakter, nem ír semmit és fordítva irja ki, így pl a evilfdp.exe-ből lehet csinálni evilexe.pdf-et


### Cybercrime
+ mert jó pénz van benne
+ adatlopás
+ MAN in the midle attack-al pénz utalásokat lehet átirányítani
+ cryptominer
+ ransom
  + gépet letitkosítani

### Conficker botnet
+ A,B és C verzió
+ egy DLL
+ sérülékenység segítségével kerül fel a gépekre
  + NetpwPathCanonicalize: a\b\\..\c -> a\c
  + buffer overflow-t lehetett csináni és a return adress-t megváltoztatni  
+ frissíthető
  + time-seeded random domain nevek
+ Hooks system calls
  + DNS szűrje az antivírus oldalakat
  + NetpwPathCanonicalize -- mit ő használt fel sérülékenységhez  javítva a hibát
    + nézi hogy ha egy bizonyos fajta shellcode jön akkor az tartalmazza a frissítést hozzá
+ Domain name generation:
  + probálták az antivírus cégek előre lefoglalni a domaineket
  + a C verzió napi 50.000 új page-t probált innentől rip
+ Removal
  + csak futás közben van szétcsomagolva, addig rejti magát
  + mutexel lehet cselezni hogy ne tudjon töbször felmászni -- ezt használja arra hogy egy instance fusson csak belőle 





























.
